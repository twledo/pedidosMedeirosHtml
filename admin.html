<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Pizzaria</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-neutral-950 via-neutral-900 to-neutral-800 min-h-screen text-white">
    <!-- Header -->
    <header
        class="fixed top-0 left-0 w-full z-40 bg-red-700/80 backdrop-blur-md shadow-lg flex justify-between items-center px-8 py-4">
        <h1 class="text-2xl md:text-3xl font-extrabold tracking-wide drop-shadow">Painel Administrativo</h1>
        <button
            class="bg-yellow-400 text-neutral-900 font-bold px-5 py-2 rounded-xl shadow-lg hover:bg-yellow-300 hover:scale-105 transition-all"
            onclick="logout()">Sair</button>
    </header>

    <!-- Main Container -->
    <main class="max-w-6xl mx-auto px-3 py-8 pt-28">
        <!-- Feedback Message -->
        <div id="message" class="hidden mb-5 px-4 py-3 rounded-xl font-semibold text-center shadow-lg"></div>

        <!-- Loading -->
        <div id="loading" class="hidden text-center py-10">
            <svg class="animate-spin h-8 w-8 text-yellow-400 mx-auto mb-2" xmlns="http://www.w3.org/2000/svg"
                fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
            </svg>
            <p class="text-yellow-300">Carregando...</p>
        </div>

        <!-- Tabs Navigation -->
        <nav class="flex flex-wrap gap-2 mb-8">
            <button
                class="tab-btn bg-neutral-900/80 py-2 px-5 rounded-xl font-bold text-white shadow hover:bg-yellow-400 hover:text-neutral-900 transition-all focus:outline-none focus:ring-2 focus:ring-yellow-400 active"
                onclick="showTab('orders', event)">üìã Pedidos</button>
            <button
                class="tab-btn bg-neutral-900/80 py-2 px-5 rounded-xl font-bold text-white shadow hover:bg-yellow-400 hover:text-neutral-900 transition-all focus:outline-none focus:ring-2 focus:ring-yellow-400"
                onclick="showTab('flavors', event)">üçï Sabores</button>
            <button
                class="tab-btn bg-neutral-900/80 py-2 px-5 rounded-xl font-bold text-white shadow hover:bg-yellow-400 hover:text-neutral-900 transition-all focus:outline-none focus:ring-2 focus:ring-yellow-400"
                onclick="showTab('sizes', event)">üìè Tamanhos</button>
            <button
                class="tab-btn bg-neutral-900/80 py-2 px-5 rounded-xl font-bold text-white shadow hover:bg-yellow-400 hover:text-neutral-900 transition-all focus:outline-none focus:ring-2 focus:ring-yellow-400"
                onclick="showTab('borders', event)">ü•™ Bordas</button>
            <button
                class="tab-btn bg-neutral-900/80 py-2 px-5 rounded-xl font-bold text-white shadow hover:bg-yellow-400 hover:text-neutral-900 transition-all focus:outline-none focus:ring-2 focus:ring-yellow-400"
                onclick="showTab('drinks', event)">ü•§ Bebidas</button>
        </nav>

        <!-- Tab Contents -->
        <section id="orders" class="tab-content block">
            <div class="bg-neutral-900/80 rounded-2xl shadow-2xl p-8 mb-10 border border-neutral-800 backdrop-blur-md">
                <h2 class="text-2xl text-yellow-400 font-extrabold mb-6 flex items-center gap-2 drop-shadow">üìã
                    Gerenciar Pedidos</h2>
                <div class="overflow-x-auto rounded-xl">
                    <table class="w-full text-base bg-neutral-950/80 rounded-xl overflow-hidden shadow">
                        <thead>
                            <tr>
                                <th class="p-3 text-yellow-400">ID</th>
                                <th class="p-3 text-yellow-400">Cliente</th>
                                <th class="p-3 text-yellow-400">Total</th>
                                <th class="p-3 text-yellow-400">Status</th>
                                <th class="p-3 text-yellow-400">Data</th>
                                <th class="p-3 text-yellow-400">A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTable">
                            <!-- Dados din√¢micos -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="flavors" class="tab-content hidden">
            <div class="bg-neutral-900/80 rounded-2xl shadow-2xl p-8 mb-10 border border-neutral-800 backdrop-blur-md">
                <h2 class="text-2xl text-yellow-400 font-extrabold mb-6 flex items-center gap-2 drop-shadow">üçï
                    Gerenciar Sabores</h2>
                <form class="grid grid-cols-1 md:grid-cols-3 gap-5 mb-5">
                    <div>
                        <label for="flavorName" class="block mb-1 font-bold text-yellow-300">Nome do Sabor</label>
                        <input type="text" id="flavorName"
                            class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400"
                            placeholder="Ex: Margherita">
                    </div>
                    <div>
                        <label for="flavorDescription" class="block mb-1 font-bold text-yellow-300">Descri√ß√£o</label>
                        <textarea id="flavorDescription"
                            class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400"
                            placeholder="Descri√ß√£o dos ingredientes..."></textarea>
                    </div>
                    <div>
                        <label for="flavorType" class="block mb-1 font-bold text-yellow-300">Sabor</label>
                        <select id="flavorType"
                            class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">
                            <option value="">Selecione</option>
                            <option value="SALGADO">Salgada</option>
                            <option value="DOCE">Doce</option>
                        </select>
                    </div>
                </form>
                <div class="flex gap-2 mb-5">
                    <button
                        class="btn btn-primary bg-yellow-400 text-neutral-900 font-bold px-4 py-2 rounded-xl shadow hover:bg-yellow-300 transition-all"
                        onclick="saveFlavor()">Salvar Sabor</button>
                    <button
                        class="btn btn-secondary bg-neutral-700 text-white px-4 py-2 rounded-xl shadow hover:bg-neutral-600 transition-all"
                        onclick="clearFlavorForm()">Limpar</button>
                </div>
                <div class="overflow-x-auto rounded-xl">
                    <table class="w-full text-base bg-neutral-950/80 rounded-xl overflow-hidden shadow">
                        <thead>
                            <tr>
                                <th class="p-3 text-yellow-400">ID</th>
                                <th class="p-3 text-yellow-400">Nome</th>
                                <th class="p-3 text-yellow-400">Descri√ß√£o</th>
                                <th class="p-3 text-yellow-400">Sabor</th>
                                <th class="p-3 text-yellow-400">A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="flavorsTable">
                            <!-- Dados din√¢micos -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="sizes" class="tab-content hidden">
            <div class="bg-neutral-900/80 rounded-2xl shadow-2xl p-8 mb-10 border border-neutral-800 backdrop-blur-md">
                <h2 class="text-2xl text-yellow-400 font-extrabold mb-6 flex items-center gap-2 drop-shadow">üìè
                    Gerenciar Tamanhos</h2>
                <form class="grid grid-cols-1 md:grid-cols-5 gap-5 mb-5">
                    <div>
                        <label for="sizeName" class="block mb-1 font-bold text-yellow-300">Nome do Tamanho</label>
                        <input type="text" id="sizeName"
                            class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400"
                            placeholder="Ex: Grande">
                    </div>
                    <div>
                        <label for="sizeDescription" class="block mb-1 font-bold text-yellow-300">Descri√ß√£o</label>
                        <input type="text" id="sizeDescription"
                            class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400"
                            placeholder="Ex: 35cm">
                    </div>
                    <div>
                        <label for="sizePieces" class="block mb-1 font-bold text-yellow-300">Peda√ßos</label>
                        <input type="number" id="sizePieces"
                            class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400"
                            placeholder="8">
                    </div>
                    <div>
                        <label for="sizePrice" class="block mb-1 font-bold text-yellow-300">Pre√ßo Base</label>
                        <input type="number" id="sizePrice" step="0.01"
                            class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400"
                            placeholder="25,90">
                    </div>
                    <div>
                        <label for="sizeFlavorsQuantity" class="block mb-1 font-bold text-yellow-300">Sabores
                            M√°ximos</label>
                        <input type="number" id="sizeFlavorsQuantity"
                            class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400"
                            placeholder="Ex: 3">
                    </div>
                </form>
                <div class="flex gap-2 mb-5">
                    <button
                        class="btn btn-primary bg-yellow-400 text-neutral-900 font-bold px-4 py-2 rounded-xl shadow hover:bg-yellow-300 transition-all"
                        onclick="saveSize()">Salvar Tamanho</button>
                    <button
                        class="btn btn-secondary bg-neutral-700 text-white px-4 py-2 rounded-xl shadow hover:bg-neutral-600 transition-all"
                        onclick="clearSizeForm()">Limpar</button>
                </div>
                <div class="overflow-x-auto rounded-xl">
                    <table class="w-full text-base bg-neutral-950/80 rounded-xl overflow-hidden shadow">
                        <thead>
                            <tr>
                                <th class="p-3 text-yellow-400">ID</th>
                                <th class="p-3 text-yellow-400">Nome</th>
                                <th class="p-3 text-yellow-400">Descri√ß√£o</th>
                                <th class="p-3 text-yellow-400">Peda√ßos</th>
                                <th class="p-3 text-yellow-400">Pre√ßo</th>
                                <th class="p-3 text-yellow-400">Sabores M√°x.</th>
                                <th class="p-3 text-yellow-400">A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="sizesTable">
                            <!-- Dados din√¢micos -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="borders" class="tab-content hidden">
            <div class="bg-neutral-900/80 rounded-2xl shadow-2xl p-8 mb-10 border border-neutral-800 backdrop-blur-md">
                <h2 class="text-2xl text-yellow-400 font-extrabold mb-6 flex items-center gap-2 drop-shadow">ü•™
                    Gerenciar Bordas</h2>
                <form class="grid grid-cols-1 md:grid-cols-2 gap-5 mb-5">
                    <div>
                        <label for="borderName" class="block mb-1 font-bold text-yellow-300">Nome da Borda</label>
                        <input type="text" id="borderName"
                            class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400"
                            placeholder="Ex: Borda de chocolate">
                    </div>
                    <div>
                        <label for="borderPrice" class="block mb-1 font-bold text-yellow-300">Pre√ßo Adicional</label>
                        <input type="number" id="borderPrice" step="0.01"
                            class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400"
                            placeholder="Ex: 5.00">
                    </div>
                </form>
                <div class="flex gap-2 mb-5">
                    <button
                        class="btn btn-primary bg-yellow-400 text-neutral-900 font-bold px-4 py-2 rounded-xl shadow hover:bg-yellow-300 transition-all"
                        onclick="saveBorder()">Salvar Borda</button>
                    <button
                        class="btn btn-secondary bg-neutral-700 text-white px-4 py-2 rounded-xl shadow hover:bg-neutral-600 transition-all"
                        onclick="clearBorderForm()">Limpar</button>
                </div>
                <div class="overflow-x-auto rounded-xl">
                    <table class="w-full text-base bg-neutral-950/80 rounded-xl overflow-hidden shadow">
                        <thead>
                            <tr>
                                <th class="p-3 text-yellow-400">ID</th>
                                <th class="p-3 text-yellow-400">Nome</th>
                                <th class="p-3 text-yellow-400">Pre√ßo</th>
                                <th class="p-3 text-yellow-400">A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="bordersTable">
                            <!-- Dados din√¢micos -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="drinks" class="tab-content hidden">
            <div class="bg-neutral-900/80 rounded-2xl shadow-2xl p-8 mb-10 border border-neutral-800 backdrop-blur-md">
                <h2 class="text-2xl text-yellow-400 font-extrabold mb-6 flex items-center gap-2 drop-shadow">ü•§
                    Gerenciar Bebidas</h2>
                <form class="grid grid-cols-1 md:grid-cols-2 gap-5 mb-5">
                    <div>
                        <label for="drinkName" class="block mb-1 font-bold text-yellow-300">Nome da Bebida</label>
                        <input type="text" id="drinkName"
                            class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400"
                            placeholder="Ex: Coca-Cola 350ml">
                    </div>
                    <div>
                        <label for="drinkPrice" class="block mb-1 font-bold text-yellow-300">Pre√ßo</label>
                        <input type="number" id="drinkPrice" step="0.01"
                            class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400"
                            placeholder="4.50">
                    </div>
                </form>
                <div class="flex gap-2 mb-5">
                    <button
                        class="btn btn-primary bg-yellow-400 text-neutral-900 font-bold px-4 py-2 rounded-xl shadow hover:bg-yellow-300 transition-all"
                        onclick="saveDrink()">Salvar Bebida</button>
                    <button
                        class="btn btn-secondary bg-neutral-700 text-white px-4 py-2 rounded-xl shadow hover:bg-neutral-600 transition-all"
                        onclick="clearDrinkForm()">Limpar</button>
                </div>
                <div class="overflow-x-auto rounded-xl">
                    <table class="w-full text-base bg-neutral-950/80 rounded-xl overflow-hidden shadow">
                        <thead>
                            <tr>
                                <th class="p-3 text-yellow-400">ID</th>
                                <th class="p-3 text-yellow-400">Nome</th>
                                <th class="p-3 text-yellow-400">Pre√ßo</th>
                                <th class="p-3 text-yellow-400">A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="drinksTable">
                            <!-- Dados din√¢micos -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal -->
    <div id="editModal"
        class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 backdrop-blur-sm hidden">
        <div class="bg-neutral-900 rounded-2xl shadow-2xl p-8 max-w-lg w-full border border-yellow-400">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-yellow-400" id="modalTitle">Editar Item</h3>
                <button class="text-2xl text-yellow-400 hover:text-red-500 transition-all"
                    onclick="closeModal()">&times;</button>
            </div>
            <div id="modalBody">
                <!-- Conte√∫do do modal ser√° inserido dinamicamente -->
            </div>
            <div class="mt-6 flex gap-3 justify-end">
                <button
                    class="bg-yellow-400 text-neutral-900 font-bold px-4 py-2 rounded-xl shadow hover:bg-yellow-300 hover:scale-105 transition-all"
                    onclick="saveModalData()">Salvar</button>
                <button
                    class="bg-neutral-700 text-white px-4 py-2 rounded-xl shadow hover:bg-neutral-600 transition-all"
                    onclick="closeModal()">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Script: igual ao seu script original, mas ajustando a parte do showTab e das mensagens para Tailwind -->
    <script>
        // Base URL da API
        const API_BASE = 'http://localhost:8080';
        let authToken = localStorage.getItem('token');
        let currentEditItem = null;
        let currentEditType = null;

        document.addEventListener('DOMContentLoaded', function () {
            if (!authToken) {
                window.location.href = '/login.html';
                return;
            }
            loadOrders();
            loadFlavors();
            loadSizes();
            loadBorders();
            loadDrinks();
        });

        function showMessage(text, type = 'success') {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = text;
            messageDiv.className = `mb-5 px-4 py-3 rounded-lg font-semibold text-center ${type === 'success'
                ? 'bg-green-900 text-green-300 border border-green-700'
                : 'bg-red-900 text-red-300 border border-red-700'
                }`;
            messageDiv.classList.remove('hidden');
            setTimeout(() => {
                messageDiv.classList.add('hidden');
            }, 4000);
        }
        function showLoading(show) {
            document.getElementById('loading').className = show ? 'text-center py-10' : 'hidden';
        }
        async function apiRequest(endpoint, options = {}) {
            showLoading(true);
            const config = {
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': authToken ? `Bearer ${authToken}` : ''
                },
                ...options
            };
            try {
                const response = await fetch(`${API_BASE}${endpoint}`, config);
                if (response.status === 401) {
                    localStorage.removeItem('token');
                    window.location.href = '/login.html';
                    return null;
                }
                const text = await response.text();
                if (!response.ok) {
                    let errorData = null;
                    try { errorData = text ? JSON.parse(text) : {}; } catch (e) { }
                    throw new Error(errorData?.message || text || 'Erro na requisi√ß√£o');
                }
                if (!text) return { success: true };
                try { return JSON.parse(text); } catch (e) { return { success: true, data: text }; }
            } catch (error) {
                showMessage(error.message, 'error');
                return null;
            } finally {
                showLoading(false);
            }
        }
        function showTab(tabName, event) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active', 'bg-red-700'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
            if (event) {
                event.target.classList.add('active', 'bg-red-700');
            }
            document.getElementById(tabName).classList.remove('hidden');
        }
        function logout() {
            localStorage.removeItem('token');
            window.location.href = '/login.html';
        }

        // Pedidos
        async function loadOrders() {
            const orders = await apiRequest('/admin/orders');
            if (orders) displayOrders(orders);
        }
        function displayOrders(orders) {
            const tbody = document.getElementById('ordersTable');
            tbody.innerHTML = '';
            orders.forEach(order => {
                const statusCls = {
                    pending: 'bg-yell text-yellow-700',
                    preparing: 'bg-yellow-300 text-yellow-900',
                    ready: 'bg-blue-200 text-blue-800',
                    delivered: 'bg-green-200 text-green-800'
                }[order.status] || 'bg-gray-200 text-gray-700';
                const row = `
                    <tr class="border-b border-neutral-800">
                        <td class="p-3">${order.id}</td>
                        <td class="p-3">${order.customerName || 'N/A'}</td>
                        <td class="p-3">R$ ${order.total ? order.total.toFixed(2) : '0.00'}</td>
                        <td class="p-3"><span class="px-3 py-1 rounded-xl text-sm font-bold ${statusCls}">${order.status}</span></td>
                        <td class="p-3">${new Date(order.createdAt).toLocaleDateString('pt-BR')}</td>
                        <td class="p-3 flex gap-1">
                            <button class="bg-yellow-400 text-neutral-900 px-2 py-1 rounded font-bold hover:bg-yellow-300" onclick="viewOrder(${order.id})">Ver</button>
                            <button class="bg-blue-600 text-white px-2 py-1 rounded font-bold hover:bg-blue-500" onclick="editOrder(${order.id})">Editar</button>
                            <button class="bg-red-600 text-white px-2 py-1 rounded font-bold hover:bg-red-500" onclick="deleteOrder(${order.id})">Excluir</button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }
        async function viewOrder(id) {
            const order = await apiRequest(`/admin/orders/${id}`);
            if (order) alert(`Pedido #${id}\nDetalhes: ${JSON.stringify(order, null, 2)}`);
        }
        async function editOrder(id) {
            const order = await apiRequest(`/admin/orders/${id}`);
            if (order) {
                currentEditItem = order;
                currentEditType = 'order';
                document.getElementById('modalTitle').textContent = `Editar Pedido #${id}`;
                document.getElementById('modalBody').innerHTML = `
                    <div>
                        <label class="block mb-1 font-bold text-yellow-300">Status</label>
                        <select id="editOrderStatus" class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">
                            <option value="pending" ${order.status === 'pending' ? 'selected' : ''}>Pendente</option>
                            <option value="preparing" ${order.status === 'preparing' ? 'selected' : ''}>Preparando</option>
                            <option value="ready" ${order.status === 'ready' ? 'selected' : ''}>Pronto</option>
                            <option value="delivered" ${order.status === 'delivered' ? 'selected' : ''}>Entregue</option>
                        </select>
                    </div>
                `;
                document.getElementById('editModal').classList.remove('hidden');
            }
        }
        async function deleteOrder(id) {
            if (confirm('Tem certeza que deseja excluir este pedido?')) {
                const result = await apiRequest(`/admin/orders/${id}`, { method: 'DELETE' });
                if (result) {
                    showMessage('Pedido exclu√≠do com sucesso!');
                    loadOrders();
                }
            }
        }
        // Sabores
        async function loadFlavors() {
            const flavors = await apiRequest('/admin/flavors');
            if (flavors) displayFlavors(flavors);
        }
        function displayFlavors(flavors) {
            const tbody = document.getElementById('flavorsTable');
            tbody.innerHTML = '';
            flavors.forEach(flavor => {
                tbody.innerHTML += `
                    <tr class="border-b border-neutral-800">
                        <td class="p-3">${flavor.id}</td>
                        <td class="p-3">${flavor.name}</td>
                        <td class="p-3">${flavor.description || 'N/A'}</td>
                        <td class="p-3">${flavor.type === 'DOCE' ? 'Doce' : 'Salgada'}</td>
                        <td class="p-3 flex gap-1">
                            <button class="bg-blue-600 text-white px-2 py-1 rounded font-bold hover:bg-blue-500" onclick="editFlavor(${flavor.id})">Editar</button>
                            <button class="bg-red-600 text-white px-2 py-1 rounded font-bold hover:bg-red-500" onclick="deleteFlavor(${flavor.id})">Excluir</button>
                        </td>
                    </tr>
                `;
            });
        }
        async function saveFlavor() {
            const name = document.getElementById('flavorName').value;
            const description = document.getElementById('flavorDescription').value;
            const type = document.getElementById('flavorType').value;
            if (!name || !type) return showMessage('Nome e sabor s√£o obrigat√≥rios!', 'error');
            const data = { name, description, type };
            const result = await apiRequest('/admin/flavors', { method: 'POST', body: JSON.stringify(data) });
            if (result) {
                showMessage('Sabor salvo com sucesso!');
                clearFlavorForm();
                loadFlavors();
            }
        }
        function clearFlavorForm() {
            document.getElementById('flavorName').value = '';
            document.getElementById('flavorDescription').value = '';
            document.getElementById('flavorType').value = '';
        }
        async function editFlavor(id) {
            const flavor = await apiRequest(`/admin/flavors/${id}`);
            if (flavor) {
                currentEditItem = flavor;
                currentEditType = 'flavor';
                document.getElementById('modalTitle').textContent = `Editar Sabor #${id}`;
                document.getElementById('modalBody').innerHTML = `
                    <div>
                        <label class="block mb-1 font-bold text-yellow-300">Nome do Sabor</label>
                        <input type="text" id="editFlavorName" value="${flavor.name}" class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">
                    </div>
                    <div>
                        <label class="block mb-1 font-bold text-yellow-300">Descri√ß√£o</label>
                        <textarea id="editFlavorDescription" class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">${flavor.description || ''}</textarea>
                    </div>
                    <div>
                        <label class="block mb-1 font-bold text-yellow-300">Sabor</label>
                        <select id="editFlavorType" class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">
                            <option value="SALGADO" ${flavor.type === 'SALGADO' ? 'selected' : ''}>Salgada</option>
                            <option value="DOCE" ${flavor.type === 'DOCE' ? 'selected' : ''}>Doce</option>
                        </select>
                    </div>
                `;
                document.getElementById('editModal').classList.remove('hidden');
            }
        }
        async function deleteFlavor(id) {
            if (confirm('Tem certeza que deseja excluir este sabor?')) {
                const result = await apiRequest(`/admin/flavors/${id}`, { method: 'DELETE' });
                if (result) {
                    showMessage('Sabor exclu√≠do com sucesso!');
                    loadFlavors();
                }
            }
        }
        // Tamanhos
        async function loadSizes() {
            const sizes = await apiRequest('/admin/sizes');
            if (sizes) displaySizes(sizes);
        }
        function displaySizes(sizes) {
            const tbody = document.getElementById('sizesTable');
            tbody.innerHTML = '';
            sizes.forEach(size => {
                tbody.innerHTML += `
                    <tr class="border-b border-neutral-800">
                        <td class="p-3">${size.id}</td>
                        <td class="p-3">${size.name}</td>
                        <td class="p-3">${size.description || 'N/A'}</td>
                        <td class="p-3">${size.pieces || 'N/A'}</td>
                        <td class="p-3">R$ ${size.price ? (size.price).toFixed(2).replace('.', ',') : '0,00'}</td>
                        <td class="p-3">${size.flavorsQuantity ?? size.flavors_quantity ?? 'N/A'}</td>
                        <td class="p-3 flex gap-1">
                            <button class="bg-blue-600 text-white px-2 py-1 rounded font-bold hover:bg-blue-500" onclick="editSize(${size.id})">Editar</button>
                            <button class="bg-red-600 text-white px-2 py-1 rounded font-bold hover:bg-red-500" onclick="deleteSize(${size.id})">Excluir</button>
                        </td>
                    </tr>
                `;
            });
        }
        async function saveSize() {
            const name = document.getElementById('sizeName').value;
            const description = document.getElementById('sizeDescription').value;
            const pieces = parseInt(document.getElementById('sizePieces').value);
            const priceValue = document.getElementById('sizePrice').value.replace(',', '.');
            const price = Math.round(parseFloat(priceValue));
            const flavorsQuantity = parseInt(document.getElementById('sizeFlavorsQuantity').value);
            if (!name || !pieces || !price || !flavorsQuantity) return showMessage('Todos os campos s√£o obrigat√≥rios!', 'error');
            const data = { name, description, pieces, price, flavorsQuantity };
            const result = await apiRequest('/admin/sizes', { method: 'POST', body: JSON.stringify(data) });
            if (result) {
                showMessage('Tamanho salvo com sucesso!');
                clearSizeForm();
                loadSizes();
            }
        }
        function clearSizeForm() {
            document.getElementById('sizeName').value = '';
            document.getElementById('sizeDescription').value = '';
            document.getElementById('sizePieces').value = '';
            document.getElementById('sizePrice').value = '';
            document.getElementById('sizeFlavorsQuantity').value = '';
        }
        async function editSize(id) {
            const size = await apiRequest(`/admin/sizes/${id}`);
            if (size) {
                currentEditItem = size;
                currentEditType = 'size';
                document.getElementById('modalTitle').textContent = `Editar Tamanho #${id}`;
                document.getElementById('modalBody').innerHTML = `
                    <div>
                        <label class="block mb-1 font-bold text-yellow-300">Nome do Tamanho</label>
                        <input type="text" id="editSizeName" value="${size.name}" class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">
                    </div>
                    <div>
                        <label class="block mb-1 font-bold text-yellow-300">Descri√ß√£o</label>
                        <input type="text" id="editSizeDescription" value="${size.description || ''}" class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">
                    </div>
                    <div>
                        <label class="block mb-1 font-bold text-yellow-300">Quantidade de Peda√ßos</label>
                        <input type="number" id="editSizePieces" value="${size.pieces || ''}" class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">
                    </div>
                    <div>
                        <label class="block mb-1 font-bold text-yellow-300">Pre√ßo Base</label>
                        <input type="number" id="editSizePrice" step="0.01" value="${size.price ? (size.price).toFixed(2).replace('.', ',') : ''}" class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">
                    </div>
                    <div>
                        <label class="block mb-1 font-bold text-yellow-300">Sabores M√°ximos</label>
                        <input type="number" id="editSizeFlavorsQuantity" value="${size.flavorsQuantity || ''}" class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">
                    </div>
                `;
                document.getElementById('editModal').classList.remove('hidden');
            }
        }
        async function deleteSize(id) {
            if (confirm('Tem certeza que deseja excluir este tamanho?')) {
                const result = await apiRequest(`/admin/sizes/${id}`, { method: 'DELETE' });
                if (result) {
                    showMessage('Tamanho exclu√≠do com sucesso!');
                    loadSizes();
                }
            }
        }

        // Bordas
        async function loadBorders() {
            const borders = await apiRequest('/admin/borders');
            if (borders) displayBorders(borders);
        }
        function displayBorders(borders) {
            const tbody = document.getElementById('bordersTable');
            tbody.innerHTML = '';
            borders.forEach(border => {
                tbody.innerHTML += `
                    <tr class="border-b border-neutral-800">
                        <td class="p-3">${border.id}</td>
                        <td class="p-3">${border.name}</td>
                        <td class="p-3">R$ ${border.price ? border.price.toFixed(2) : '0.00'}</td>
                        <td class="p-3 flex gap-1">
                            <button class="bg-blue-600 text-white px-2 py-1 rounded font-bold hover:bg-blue-500" onclick="editBorder(${border.id})">Editar</button>
                            <button class="bg-red-600 text-white px-2 py-1 rounded font-bold hover:bg-red-500" onclick="deleteBorder(${border.id})">Excluir</button>
                        </td>
                    </tr>
                `;
            });
        }
        async function saveBorder() {
            const name = document.getElementById('borderName').value;
            const price = parseFloat(document.getElementById('borderPrice').value);
            if (!name || !price) return showMessage('Nome e pre√ßo s√£o obrigat√≥rios!', 'error');
            const data = { name, price };
            const result = await apiRequest('/admin/borders', { method: 'POST', body: JSON.stringify(data) });
            if (result) {
                showMessage('Borda salva com sucesso!');
                clearBorderForm();
                loadBorders();
            }
        }
        function clearBorderForm() {
            document.getElementById('borderName').value = '';
            document.getElementById('borderPrice').value = '';
        }
        async function editBorder(id) {
            const border = await apiRequest(`/admin/borders/${id}`);
            if (border) {
                currentEditItem = border;
                currentEditType = 'border';
                document.getElementById('modalTitle').textContent = `Editar Borda #${id}`;
                document.getElementById('modalBody').innerHTML = `
                    <div>
                        <label class="block mb-1 font-bold text-yellow-300">Nome da Borda</label>
                        <input type="text" id="editBorderName" value="${border.name}" class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">
                    </div>
                    <div>
                        <label class="block mb-1 font-bold text-yellow-300">Pre√ßo Adicional</label>
                        <input type="number" id="editBorderPrice" step="0.01" value="${border.price || ''}" class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">
                    </div>
                `;
                document.getElementById('editModal').classList.remove('hidden');
            }
        }
        async function deleteBorder(id) {
            if (confirm('Tem certeza que deseja excluir esta borda?')) {
                const result = await apiRequest(`/admin/borders/${id}`, { method: 'DELETE' });
                if (result) {
                    showMessage('Borda exclu√≠da com sucesso!');
                    loadBorders();
                }
            }
        }
        // Bebidas
        async function loadDrinks() {
            const drinks = await apiRequest('/admin/drinks');
            if (drinks) displayDrinks(drinks);
        }
        function displayDrinks(drinks) {
            const tbody = document.getElementById('drinksTable');
            tbody.innerHTML = '';
            drinks.forEach(drink => {
                tbody.innerHTML += `
                    <tr class="border-b border-neutral-800">
                        <td class="p-3">${drink.id}</td>
                        <td class="p-3">${drink.name}</td>
                        <td class="p-3">R$ ${drink.price ? drink.price.toFixed(2) : '0.00'}</td>
                        <td class="p-3 flex gap-1">
                            <button class="bg-blue-600 text-white px-2 py-1 rounded font-bold hover:bg-blue-500" onclick="editDrink(${drink.id})">Editar</button>
                            <button class="bg-red-600 text-white px-2 py-1 rounded font-bold hover:bg-red-500" onclick="deleteDrink(${drink.id})">Excluir</button>
                        </td>
                    </tr>
                `;
            });
        }
        async function saveDrink() {
            const name = document.getElementById('drinkName').value;
            const price = parseFloat(document.getElementById('drinkPrice').value);
            if (!name || !price) return showMessage('Nome e pre√ßo s√£o obrigat√≥rios!', 'error');
            const data = { name, price };
            const result = await apiRequest('/admin/drinks', { method: 'POST', body: JSON.stringify(data) });
            if (result) {
                showMessage('Bebida salva com sucesso!');
                clearDrinkForm();
                loadDrinks();
            }
        }
        function clearDrinkForm() {
            document.getElementById('drinkName').value = '';
            document.getElementById('drinkPrice').value = '';
        }
        async function editDrink(id) {
            const drink = await apiRequest(`/admin/drinks/${id}`);
            if (drink) {
                currentEditItem = drink;
                currentEditType = 'drink';
                document.getElementById('modalTitle').textContent = `Editar Bebida #${id}`;
                document.getElementById('modalBody').innerHTML = `
                    <div>
                        <label class="block mb-1 font-bold text-yellow-300">Nome da Bebida</label>
                        <input type="text" id="editDrinkName" value="${drink.name}" class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">
                    </div>
                    <div>
                        <label class="block mb-1 font-bold text-yellow-300">Pre√ßo</label>
                        <input type="number" id="editDrinkPrice" step="0.01" value="${drink.price || ''}" class="w-full bg-neutral-800 rounded px-3 py-2 text-white focus:ring-2 focus:ring-yellow-400">
                    </div>
                `;
                document.getElementById('editModal').classList.remove('hidden');
            }
        }
        async function deleteDrink(id) {
            if (confirm('Tem certeza que deseja excluir esta bebida?')) {
                const result = await apiRequest(`/admin/drinks/${id}`, { method: 'DELETE' });
                if (result) {
                    showMessage('Bebida exclu√≠da com sucesso!');
                    loadDrinks();
                }
            }
        }
        // Modal
        function closeModal() {
            document.getElementById('editModal').classList.add('hidden');
            currentEditItem = null;
            currentEditType = null;
        }
        async function saveModalData() {
            if (currentEditType === 'order' && currentEditItem) {
                const status = document.getElementById('editOrderStatus').value;
                const result = await apiRequest(`/admin/orders/${currentEditItem.id}`, {
                    method: 'PUT',
                    body: JSON.stringify({ status })
                });
                if (result) {
                    showMessage('Pedido atualizado com sucesso!');
                    closeModal();
                    loadOrders();
                }
            } else if (currentEditType === 'flavor' && currentEditItem) {
                const name = document.getElementById('editFlavorName').value;
                const description = document.getElementById('editFlavorDescription').value;
                const type = document.getElementById('editFlavorType').value;
                if (!name || !type) return showMessage('Nome e sabor s√£o obrigat√≥rios!', 'error');
                const data = { name, description, type };
                const result = await apiRequest(`/admin/flavors/${currentEditItem.id}`, {
                    method: 'PUT',
                    body: JSON.stringify(data)
                });
                if (result) {
                    showMessage('Sabor atualizado com sucesso!');
                    closeModal();
                    loadFlavors();
                }
            } else if (currentEditType === 'size' && currentEditItem) {
                const name = document.getElementById('editSizeName').value;
                const description = document.getElementById('editSizeDescription').value;
                const pieces = parseInt(document.getElementById('editSizePieces').value);
                const priceValue = document.getElementById('editSizePrice').value.replace(',', '.');
                const price = Math.round(parseFloat(priceValue));
                const flavorsQuantity = parseInt(document.getElementById('editSizeFlavorsQuantity').value);
                if (!name || !pieces || !price || !flavorsQuantity) return showMessage('Todos os campos s√£o obrigat√≥rios!', 'error');
                const data = { name, description, pieces, price, flavorsQuantity };
                const result = await apiRequest(`/admin/sizes/${currentEditItem.id}`, {
                    method: 'PUT',
                    body: JSON.stringify(data)
                });
                if (result) {
                    showMessage('Tamanho atualizado com sucesso!');
                    closeModal();
                    loadSizes();
                }
            } else if (currentEditType === 'border' && currentEditItem) {
                const name = document.getElementById('editBorderName').value;
                const price = parseFloat(document.getElementById('editBorderPrice').value);
                if (!name || !price) return showMessage('Nome e pre√ßo s√£o obrigat√≥rios!', 'error');
                const data = { name, price };
                const result = await apiRequest(`/admin/borders/${currentEditItem.id}`, {
                    method: 'PUT',
                    body: JSON.stringify(data)
                });
                if (result) {
                    showMessage('Borda atualizada com sucesso!');
                    closeModal();
                    loadBorders();
                }
            } else if (currentEditType === 'drink' && currentEditItem) {
                const name = document.getElementById('editDrinkName').value;
                const price = parseFloat(document.getElementById('editDrinkPrice').value);
                if (!name || !price) return showMessage('Nome e pre√ßo s√£o obrigat√≥rios!', 'error');
                const data = { name, price };
                const result = await apiRequest(`/admin/drinks/${currentEditItem.id}`, {
                    method: 'PUT',
                    body: JSON.stringify(data)
                });
                if (result) {
                    showMessage('Bebida atualizada com sucesso!');
                    closeModal();
                    loadDrinks();
                }
            }
        }
        document.getElementById('editModal').addEventListener('click', function (e) {
            if (e.target === this) closeModal();
        });
    </script>
</body>

</html>